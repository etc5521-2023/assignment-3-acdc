---
title: "Weeping Mulla Mulla: Ptilotus Calostachyus"
author: "**Team name:** ACDC </br> **Team members:** </br> Khuyen Nguyen _kngu0086@student.monash.edu_ </br> Khanh Pham _mpha0054@student.monash.edu_"
format: 
  html: 
    theme: minty
toc: true
editor: 
  markdown: 
    wrap: 72
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(cowplot)
library(galah)
library(kableExtra)
library(leaflet)
library(nullabor)
library(plotly)
library(rnoaa)
library(spData)
library(tidyverse)
library(visdat)
library(tsibble)
library(lubridate)
library(sf)
library(rmapshaper)
library(zoo)
```

## Introduction

The *Ptilotus calostachyusÂ F.Muell*, which is also known as the
**Weeping Mulla Mulla**, is an endemic plant that is commonly found in
the Western Australia territory (Florabase n. d.). This species thrives
in arid region, particular in sandy habitats with red and stony plains
(Florabase n. d.). Being a *perennial* plant, it can live up to more
than two years with the seasonal pattern of being dormant in the winter
and sprouting again in springtime (Florabase n. d.). Moreover, **Weeping
Mulla Mulla** displays erect or spreading, herb or shrub
characteristics, meaning that it can be found as a tall plant and/or
covering an area, as well as with/without a woody body. They can grow
from 0.2 to 2 meters tall with pink-white flowers, blooming from March
to October. Despite the widespread of its coverage, there are little to
none organized sighting campaign of the **Weeping Mulla Mulla** due to
the outback nature of its habitat and lesser popularity as compared to
other iconic Australia ecotourism species.

Five expectations when exploring the **Weeping Mulla Mulla** sightings:

-   We expect most of the sightings to occur between March to October.

-   We expect most of the sighting location to be in the Western
    Australia territory.

-   We expect the sightings to be consistent numbers of sightings with
    an increasing trend as sighting/reporting/monitoring methods become
    better. However, this anticipation will exclude years during the
    COVID-19 pandemic. Since the data relies on human observation, there
    may be fewer sightings due to a lack of reporting.

-   We expect the sightings to be clustered in areas with a water source
    as the plant prefers harsh, dry, and hot sandy habitats.

-   We expect the sightings records to increase after rainfall events,
    as plants typically begin to bloom after wet season, which is around
    June - August for Perth.

This report aims to provide a comprehensive analysis of the **Weeping
Mulla Mulla**, utilising primary data sources from the *ALA Atlas of
Living Australia* and the *Global Historical Climatology Network (GHCN)*
database.

Throughout this exploration of expectations, numerous intriguing
observations were uncovered that were not initially anticipated.
Notably, the employment of `spData` and `leaflet` effectively visualised
these findings and allows for interactivity.

It is important to note several limitations that have affected the final
analysis. Firstly, there is a scarcity of observations, primarily
because this plant is not commonly sought after or reported by
individuals. Secondly, the absence of weather recordings in remote areas
may lead to gaps in the dataset.

![](https://static.inaturalist.org/photos/54862576/medium.jpg){fig-align="center"}

## Data description

### Species data

Below is the code to download the raw data directly from *ALA Atlas of
Living Australia*.

The basis of record was filtered to `HUMAN_OBSERVATION` only. The
intention of this analysis is to focus solely on sightings of the
species in the wild, and differentiate between specimens that are
preserved, collected samples, or in controlled environments such as
museums.

We have also checked the `BASIS_OF_RECORD_INVALID` to determine the
reliability of each observation, in which all the `TRUE` results were
removed in the process of sub-setting `HUMAN_OBSERVATION` entry in the
`basisOfRecord`.

The other options, such as `LIVING SPECIMEN`, could imply captivity or
control, `PRESERVED SPECIMEN` typically refers to non-living specimens,
and `OCCURRENCE` was too general to confirm its wild state.

```{r raw-data, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
galah_config(email = "mpha0054@student.monash.edu",
             download_reason_id = 10, 
             verbose = TRUE)

raw_data <- ala_occurrences(
  taxa = select_taxa("Ptilotus calostachyus"))

save(raw_data, file = "data-raw/raw_data.rda")
```

```{r message=FALSE, warning=FALSE, echo=FALSE}
galah_config(email = "mpha0054@student.monash.edu",
             download_reason_id = 10, 
             verbose = TRUE)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
storage <- galah_call() %>%
  galah_identify("Weeping mulla mulla") %>%
  galah_select(
    basisOfRecord, decimalLatitude, decimalLongitude, eventDate, scientificName,
    taxonConceptID, recordID, dataResourceName, eventRemarks, eventTime, eventID,
    eventDate, samplingEffort, samplingProtocol, cl959,
    group = c("basic", "event")
  ) %>%
  atlas_occurrences() %>%
  filter(basisOfRecord == "HUMAN_OBSERVATION")

# this workaround is done because the message "Checking queue Current queue size: 1 inqueue ." do not go away even if we use warning or message = false
```

The data obtained from the Atlas of Living Australia website combines
information from multiple sources and includes various variables such as
location, date, time, scientific names, resource names, species status,
and more. The raw data set contains `r nrow(storage)` observations and
`r ncol(storage)` variables.

For the analysis, the data is filtered to primarily focus on utilising
the location and event time data. This is because the other variables do
not contribute significantly to meaningful insights. However, a
comprehensive dictionary of all the variables is provided below:

```{r data-dictionary, echo=FALSE, warning=FALSE}
dictionary <- data.frame(
  Variable = c("decimalLatitude", "decimalLongitude", "eventDate", "scientificName", "taxonConceptID", "recordID", "dataResourceName",  "occurrenceStatus", "eventRemarks", "eventTime", "eventID", "samplingEffort", "samplingProtocol", "basisOfRecord", "cl959"),
  Description = c(
    "Latitude value of sighting in decimal format.",
    "Longitude value of sighting in decimal format.",
    "Recorded sighting date and time in the format YYYY-MM-DD, hh:mm:ss. In some cases, no time was recorded, and therefore, it is left as 00:00:00.",
    "The scientific name of the observed species.",
    "The taxonomy website ID: [Ptilotus calostachyus](https://id.biodiversity.org.au/node/apni/2910906).",
    "The record ID of each observation.",
    "The data resource associated with the observation: [List of 23 partners](https://bie.ala.org.au/species/https://id.biodiversity.org.au/node/apni/2910906#data-partners).",
    "The occurrence status: Present.",
    "Any additional remarks or comments related to the observation.",
    "Time of the event recorded in the format hh:mm:ss, including the time zone difference.",
    "The event ID of each obsercation.",
    "A description of the effort or area that was surveyed or sampled to locate the species.",
    "The protocol that was used to sample the species.",
    "Indicates how the record was made: Human observation.",
    "Denotes the local government area where the observation was made."
  )
)

kable(dictionary, format = "markdown", caption = "**Data Dictionary for the Weeping Mulla Mulla dataset**")
```

### Data cleaning

As mentioned earlier, only location and event time variables
significantly contribute to the analysis. Methods for selecting and
renaming variables, extracting time variables from the date, and
removing unnecessary strings and missing values were applied before
saving a clean version for further analysis. The code for data cleaning
can be referred to below:

```{r species-data-cleaning}
weeping_mulla_mulla <- storage %>%
  select(decimalLongitude, decimalLatitude, eventDate, cl959) %>%
  rename(longitude = decimalLongitude,
         latitude = decimalLatitude,
         lga = cl959) %>%
  mutate(
    eventDate = as.Date(eventDate),
    Year = lubridate::year(eventDate),
    Month = lubridate::month(eventDate),
    monthName = lubridate::month(eventDate, label = TRUE, abbr = TRUE),
    Day = lubridate::day(eventDate),
    lga = str_remove(lga, "\\(.*")
  ) %>%
  filter(!is.na(eventDate)) %>%
  filter(!is.na(longitude)) 
save(weeping_mulla_mulla, file = ("data/weeping_mulla_mulla.rda"))
```

## Initial data analysis

### Weather data

#### **Obtaining weather station data**

The distribution of the **Weeping Mulla Mulla** commonly spans the local
government areas (LGAs) of Ashburton, Broome, Derby-West Kimberley, East
Pilbara, Halls Creek, Karratha, Laverton, Meekatharra, Ngaanyatjarraku,
Port Hedland, Upper Gascoyne, and Wyndham-East Kimberley, as per
findings from
([Florabase](https://florabase.dbca.wa.gov.au/browse/profile.php/2704)).

Since weather is an important factor in the occurrences of species, the
Global Historical Climatology Network (GHCN) database contains weather
station data that are useful for analysing trends in weather patterns
and precipitation. Obtaining the data via the `rnoaa` package for
Australia was completed using the code below:

```{r weather-data, warning=FALSE, message=FALSE}
aus_stations <- ghcnd_stations() |>
  filter(str_starts(id, "ASN")) |>
  filter(last_year >= 2020) |> 
  mutate(wmo_id = as.numeric(wmo_id),
         name = str_to_lower(name)) |>
  select(-state, -gsn_flag) |>
  filter(element %in% c("PRCP", "TMAX", "TMIN")) |>
  nest(element: last_year) |>
  rowwise() |>
  filter(nrow(data) == 3) |>
  select(-data) 
```

Next, when filtering the weather stations to be within the vicinity of
**Weeping Mulla Mulla**, it becomes evident that the **Weeping Mulla
Mulla** is found in the vicinity of 42 weather stations.

```{r, echo=FALSE, results=FALSE}
range(weeping_mulla_mulla$longitude)
range(weeping_mulla_mulla$latitude)

aus_stations_filtered <- aus_stations %>% 
  filter(115.6102 <= longitude & longitude <= 137.1930,
         -24.92637 <= latitude & latitude <= -15.14837)
```

```{r echo=FALSE}
#| fig-align: center
#| echo: false
data(world, package = "spData")
australia <- world[world$iso_a2 == "AU", ]

australia_plot <- ggplot(australia) + geom_sf(fill = "#f3edd7")

combined_plot <- australia_plot +
  geom_point(data = weeping_mulla_mulla,
             aes(x = longitude, y = latitude),
             colour = "#c599b2", alpha= 0.3, size = 2.5) +
 labs(title = "Weeping Mulla Mulla Sightings & Weather Stations", 
       x = "Longitude", 
       y = "Latitude", 
       subtitle = "1987 - Present") +
  theme_minimal()

combined_plot +
  geom_point(
    data = aus_stations_filtered,
    aes(
      x = longitude,
      y = latitude,
      color = name == "tennant creek airport"
    ),
    shape = 2
  ) +
 scale_color_manual(
    name = "Weather Stations",
    values = c("FALSE" = "#222233", "TRUE" = "red"),
    breaks = c(FALSE, TRUE), 
    labels = c("Other", "Tennant Creek Airport") 
  )
```

The triangles on the map represent the locations of 42 weather stations.
The purple points, with varying alpha and size settings, help to
identify the areas with the highest occurrence rates. Notably, the red
triangle represents the Tennant Creek Airport weather station, which
records the majority of observations. Given this focus, the analysis can
be narrowed down by filtering the weather station data specifically for
Tennant Creek.

For another view of these findings, the same map was recreated using
`leaflet`:

```{r echo=FALSE}
#| fig-align: center
#| echo: false
weeping_mulla_mulla %>%
  leaflet() %>%
  addProviderTiles("Esri.DeLorme") %>%
  setView(lat = -21.833, lng = 128.583, zoom = 5) %>%
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude,  
                   stroke = FALSE, 
                   fillOpacity = 0.1,
                   color = "#c599b2",
                   radius = 10) %>%
  addCircleMarkers(data = aus_stations_filtered,  
                   lng = ~longitude,
                   lat = ~latitude,
                   stroke = FALSE, 
                   fillOpacity = 1,  
                   color = "#222233",      
                   radius = 3) %>% 
   addCircleMarkers(data = aus_stations_filtered %>% filter(name == "tennant creek airport"),
                   lng = ~longitude,
                   lat = ~latitude,
                   stroke = FALSE, 
                   fillOpacity = 1,  
                   color = "red",      
                   radius = 5)
```

#### **Obtaining weather data for Tennant Creek**

The code for obtaining precipitation, maximum temperature, and minimum
temperature data for Tennant Creek is provided below by filtering using
the station ID ASN00015135:

```{r, warning=FALSE, message=FALSE}
tennant_creek_airport <- aus_stations |>
  filter(id == "ASN00015135") |>
  rowwise() |>
  mutate(ts = list(meteo_pull_monitors(
    monitors = id, var = c("PRCP", "TMAX", "TMIN"),
    date_min = "2004-01-01",
    date_max = "2023-09-13") |>
      select(-id))) |>
  rename(lat = latitude, long = longitude, elev = elevation) |> 
  select(id, long, lat, elev, name, wmo_id, ts) %>%
  unnest(ts) |>
  mutate(tmax = tmax/10, tmin = tmin/ 10)
```

**Tennant Creek in Barkly Region**

The `weeping_mulla_mulla` dataset has included local government
information. Given that Tennant Creek is situated in the local
government area of Barkly, the final step involves integrating the
species data set with temperature data from weather stations and
highlighting those observations belonging to the Barkly region.

A new column named `sighting` is created. This column serves the crucial
purpose of indicating whether a sighting occurred on a particular day or
not and whether temperature data is available. Consequently, as all the
observations within the Barkly region have corresponding temperature
data, a comprehensive dataset can be generated that encompasses both
observational data and daily weather information. Dates with records in
this region would be given **1** while others would be **0**.

```{r}
temperature <- tennant_creek_airport %>%
  left_join(weeping_mulla_mulla, by = c("date" = "eventDate")) %>%
  mutate(sighting = ifelse(lga == "Barkly ", 1, 0)) %>%
  mutate(sighting = ifelse(is.na(sighting), 0, sighting)) %>%
  select(-11:-17) 

save(temperature, file = ("data/temperature.rda"))
```

### Checking data quality (Weeping Mulla Mulla)

We will be using `visdat` library to check for data type errors

```{r message=FALSE, warning=FALSE}
#| label: fig-plots1
#| fig-cap: "vis_dat() results of weeping_mulla_mulla"
#| fig-align: center
#| echo: false
vis_dat(weeping_mulla_mulla)
```

**Discussion**

In @fig-plots1, the result of `visdat` does not signify any anomalies
that needed to be addressed before proceeding with further analysis.

```{r message=FALSE, warning=FALSE}
#| label: fig-plots2
#| fig-cap: "vis_guess() results of weeping_mulla_mulla"
#| fig-align: center
#| echo: false
vis_guess(weeping_mulla_mulla)
```

**Discussion**

In @fig-plots2, `vis_guess` shows that the *longitude* and *latitude*
columns both have a record with potentially integer coordinates entry.
While this is a sign of rounding given that the coordinates span from a
length of values with 5 decimal places precision, we believe this value
does not need any alterations as sighting coordinates span across a very
wide geographical area, making rounding to the nearest whole number (1.0
degree is 111 kilometers) insignificant in our spatial analysis.

### Checking data quality (Temperature)

Similarly, we will be using `visdat` library to check for data type
errors

```{r message=FALSE, warning=FALSE}
#| label: fig-plots98
#| fig-cap: "vis_dat() results of temperature"
#| fig-align: center
#| echo: false
vis_dat(temperature)
```

From the @fig-plots98, we can see that there are some NAs in `prcp`,
`tmax`, and `tmin` columns. These empty data observations will then be
removed accordingly.

```{r message=FALSE, warning=FALSE}
#| label: fig-plots97
#| fig-cap: "vis_guess() results of temperature"
#| fig-align: center
#| echo: false
vis_guess(temperature)
```

@fig-plots97 shows that both `tmax` and `tmin` consists of both integers
and double, which is reasonable as there might be some dates where the
temperature is rounded up to the whole numbers. Moreover, this is
rounding up is neglectable to us since we are not interested in such
precision in temperature measurements. Some NAs were carried over fromt
the previous vis_dat() results, which will be removed as they lack the
necessary data from further analysis.

```{r}
modified_temperature <- 
  temperature %>% 
  na.omit()
save(modified_temperature, file = ("data/temperature.rda"))
```

The modified temperature data has been updated.

### Tourism Data

We are going to extend our focus beyond the mere observation of this
wild flower by looking into the tourism activities within its habitat.
Leveraging data sourced from Tourism Research Australia (TRA), our objective
is to discern whether the tourist activities have played a role in the
number of Weeping Mulla Mulla sightings. In doing so, there are some
steps that have to be done to combine the occurence information and the
tourism activities.

#### Loading Tourism Data

As we have been given the tourism dataset, below is the table containing
some variables in this data:

```{r tourism}
load("data/tourism.rda")

# Suggested way to clean data
# tourism <- tourism %>% 
#  janitor::clean_names() %>% 
#  mutate(region = as.factor(region),
#         rurpose = as.factor(purpose))
```

| Variables | Description                                                                        |
|-------------|-----------------------------------------------------------|
| Quarter   | The Year and Quarter when the trips happened                                       |
| Region    | The Region where the people going to. Region is equivalent to Statistical Area 2.  |
| Purpose   | The reason of the trips (Business, Holiday, Other).                                |
| Trips     | Number of people doing the trip (divide by 1000).                                                   |

: Tourism Data


#### Join the Occurences Data with Tourism Data

To join these two dataset, we are planning to use the spatial and temporal data that is contained in each dataset as the join condition. We are going to start the preparation for temporal variables before we move to spatial variables. Hence, in the next section the order will be temporal then spatial.

##### Preparation for the Temporal Data

The temporal variables between Occurences and Tourism data are represented by `eventDate` and `Quarter` variables, respectively. As both of these variables are in different format, we are going to transform one of them to enable the join process later. In this case, we are going to break down the `eventDate` variable into year & quarter format.

```{r}
# Adding new yearquarter column
weeping_mulla_mulla <- weeping_mulla_mulla %>%
                          mutate(Year_Quarter = yearquarter(eventDate))
```


##### Preparation for the Spatial Data

As we know, the spatial variables between Tourism and Occurences data are presented by `Region` and `longitude` & `latitude`, respectively. It is not possible to just join the data based on the value of these variables, so some data transformations are needed. Looking at the extraction code (given) for Tourism data and researching TRA's website [here](https://www.tra.gov.au/en/regional/tourism-regions.html), we have got the idea that `Region` variable is the area level of the Statistical Area 2 (SA2). The SA2 is part of the main structure of the Australian Statistical Geography Standard (ASGS) Edition 3, meaning we can use its shapefile and extract the geometry of every region in Australia (which contain longitude & latitude values). We will match the `geometry` in the SA2 data with `longitude` & `latitude` in the Occurences dataset to get the SA2 region name of each sighting. The code below will provide the step-by-step of the extraction process.

```{r}
# Get shapefile
AU_region <- st_read(here::here("data/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")) %>%
  ms_simplify(keep = 0.1) %>%
  st_transform(crs = st_crs("WGS84")) %>%
  st_make_valid() %>%
  select(STE_NAME21, SA2_NAME21, SA2_CODE21, geometry) %>%
  rename("state" = STE_NAME21,
         "region" = SA2_NAME21,
         "sa2_code21" = SA2_CODE21)


# Convert Occurences data to a sf object
wmm_sf <- weeping_mulla_mulla %>%
  st_as_sf(coords = c("longitude", "latitude"),
  crs = st_crs("WGS84"))


# Join
## some points are out of the polygon, lets filter out so we get only points in the polygon
wmm_region <-
  st_join(AU_region, wmm_sf, left = TRUE) %>%  # spatial join to get intersection of points and poly
  filter(!is.na(region), # get only the points (sightings) that fall in the polygon (tourism region)
         !is.na(eventDate)) # filter out the NA values that represents mismatch geometry with Occurences data
```

##### Join Temporal and Spatial Data

Now, our Occurence data has matching region name with the region in the Tourism data, we also have transformed the format for temporal variables. Finally, We can start to join the temporal and spatial variables between these two datasets.
```{r joined_data, warning = false, message = false}
wmm_tourism <- wmm_region %>%
                left_join(tourism, by = c("region" = "Region", "Year_Quarter" = "Quarter"))
```

## Exploratory data analysis

### Spatial expectation

To evaluate the spatial distribution of the species, a method involving
the use of a map to pinpoint locations was employed. This was achieved
by utilising the `spData` package in conjunction with its `world` data.

```{r ,include=FALSE}
#| include: false
temperature <- tennant_creek_airport %>%
  left_join(weeping_mulla_mulla, by = c("date" = "eventDate")) %>%
  select(date:Day) %>% 
  mutate(sighting = ifelse(lga == "Barkly ", 1, 0))
```

```{r}
#| label: fig-plots3
#| fig-cap: "Weeping Mulla Mulla Sightings Across Australia"
#| fig-align: center
#| echo: false

data(world, package = "spData")
australia <- world[world$iso_a2 == "AU", ]

australia_plot <- ggplot(australia) + geom_sf(fill = "#f3edd7") 

combined_plot <- australia_plot +
  geom_point(data = weeping_mulla_mulla,
             aes(x = longitude, y = latitude),
             colour = "#c599b2") +
  labs(title = "Weeping Mulla Mulla Sightings Across Australia", 
       x = "Longitude", 
       y = "Latitude", 
       subtitle = "1987 - Present") +
  theme_minimal()

combined_plot
```

The initial expectation was that the majority of sightings would be
concentrated in Western Australia (@fig-plots3).

The map displaying the sightings below validates the initial hypothesis.
However, it also reveals a significant number of sightings in the
Northern Territory.

Most of the sightings are clustered in the northern regions of Western
Australia, aligning with expectations. Notably, there are no sightings
in the southern areas of Western Australia, including the city of Perth.

### Temporal expectation

To assess the temporal occurrences of the species, the same method of
using a map to pinpoint locations was employed. However, an additional
step was introduced, involving the segmentation of the data by month to
distribute the results throughout the year.

The initial expectation was that the **Weeping Mulla Mulla** would
exhibit a higher frequency of observations from March to October
("Active" months).

The map (@fig-plots4) displaying the sightings by month validates this
initial hypothesis, as there are fewer data points on the map in January
and February, as well as in November and December.

Interestingly, a new insight emerges when the data is segmented by
month. The previous map showed the regions where observations were most
frequent, namely Western Australia and the Northern Territory. Now, when
the data is subset by month, it becomes apparent that these two regions
remain the primary clusters.

```{r, echo = FALSE}
#| label: fig-plots4
#| fig-cap: "Weeping Mulla Mulla Sightings By Month"
#| fig-align: center
#| echo: false
combined_plot +
  facet_wrap(~monthName, ncol = 6) +
  theme_void() +
  labs(title = "Weeping Mulla Mulla Sightings By Month")
```

To test the validity of our visual inference, we decided to employ
`nullabor` null plots. Our hypotheses are as follows:

-   $H_0:$ There is no difference in the distribution of geographical
    points between the "Active" months and the "Others" months.
-   $H_1:$ There is a difference in the distribution of geographical
    points between the "Active" months and the "Others" months.

```{r, echo=FALSE}
#| label: fig-plots5
#| fig-cap: "Weeping Mulla Mulla Sightings Null Plots"
#| fig-align: center
#| echo: false
set.seed(20190709)

custom_weep <- weeping_mulla_mulla

custom_weep$Month <- ifelse(custom_weep$Month >= 3 & custom_weep$Month <= 10, "Active", "Others")

data(world, package = "spData")
australia <- world[world$iso_a2 == "AU", ]

australia_plot <- ggplot(australia) + geom_sf(fill = "#f3edd7") 

combined_plot <- australia_plot +
  geom_point(data = lineup(null_permute('Month'), custom_weep),
             aes(x = longitude, y = latitude, col = Month)) +
  coord_sf(xlim = c(110 , 145 ), ylim = c(-10, -30)) +
  facet_wrap(~.sample, ncol=5) +
  theme_void() +
  theme(axis.text = element_blank(), 
        panel.border = element_rect(fill=NA, colour="black"),
        legend.position = "None")

combined_plot
```

We have given the null plots (@fig-plots5) to around 14 friends and only
one of them picked the true plot at 16. This equates to the p-values
below:

```{r}
pvisual(1,14,20)
```

`x simulated` shows 0.4612 and `binom` shows 0.512325 - both are above
the threshold 0.05, which means that we fail to reject the null
hypothesis in favor of the alternative hypothesis. Consequently, we are
95% confident that the selection of the true plot is by chance and there
is no association between the combinations of `longitude` and `latitude`
for different `Month` periods ("*Active*" and "*Others*"). This means
that the **Weeping Mulla Mulla** can still be found outside of their
active months without being in specific area.

### Trend expectation

Since the data relies on human observation, it was anticipated that
there might have been fewer sightings due to a lack of reporting.

By employing a simple method of plotting the number of observations
against the years using a histogram (@fig-plots99), it can be seen that
there was no indication of reduced observations during the COVID-19
years from 2000 to 2021. In fact, 2021 recorded the second-highest
number of observations for the species.

Nevertheless, an interesting new observation stands out - a significant
spike in sightings occurred in 2015. This spike was the highest,
surpassing even the sightings in 2021, with 108 observations compared to
34, which is more than three times as many.

Currently, there are no findings that can explain this phenomenon. Given
that the years after 2015 usually saw much higher reported sightings as
compared to the previous, we hypothesize that this effect is due to the
proliferation of internet-of-things, allowing sightings to be reported
with greater ease and more reliable reporting platforms/databanks.

```{r, echo=FALSE, warning =FALSE}
#| label: fig-plots99
#| fig-cap: "Weeping Mulla Mulla Observations by Year"
#| fig-align: center
#| echo: false
wrapper <- weeping_mulla_mulla %>%
  group_by(Year) %>%
  count() %>%
  ggplot(aes(x = Year, y = n, fill = as.factor(Year))) +
  geom_histogram(stat = "identity") +
  scale_fill_manual(values = c("2020" = "firebrick4", "2021" = "firebrick4")) +
  labs(
    title = "Weeping Mulla Mulla Observations by Year",
    y = "Number of observations"
  ) +
  theme_minimal() +
  theme(legend.position = "none", legend.title = element_blank())
ggplotly(wrapper)
```

### Seasonality expectation

To test whether our expectation that the **Weeping Mulla Mulla** becomes
more active after rainfall seasons is accurate, we decided to plot the
occurrences by month. While there are some indications from the previous
*Temporal expectation* section, where June to August plots show
considerably more observation points, we would like create a bar plot
for a better visualization inference.

```{r}
#| label: fig-plots6
#| fig-cap: "Weeping Mulla Mulla Observations by Month (Bars)"
#| fig-align: center
#| echo: false
wrapper1 <- weeping_mulla_mulla %>%
  group_by(monthName) %>%
  count() %>%
  ggplot(aes(x = monthName, y = n, fill = as.factor(monthName))) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("Jun" = "#c599b2", 
                               "Jul" = "#c599b2", 
                               "Aug" = "#c599b2")) +
  labs(
    title = "Weeping Mulla Mulla Observations by Month",
    y = "Number of observations",
    x = "Month"
  ) +
  theme_minimal() +
  theme(legend.position = "none", legend.title = element_blank())
ggplotly(wrapper1)
```

Interestingly, we observe decreased sightings during June and July while
August has the highest sighting occurrences (@fig-plots6). March marks
the start of the blooming cycle with April and May being the autumn
season in Western Australia (Tourism Australia n. d.), which has
occasional showers. This explains the large rise in sightings for these
months. However, the main raining events (June to August) saw
significantly lower occurrences - we believe this is due to
thunderstorms and flooding, preventing casual observers to stumble upon
these plants. Only August has high sighting occurrences, as the end of
winter has milder downpours.

### Habitat expectation

Given that the **Weeping Mulla Mulla** prefers stony and sandy
environments, we expect the plants to be sighted near areas with
freshwater such as river banks. Moreover, observations by travelers
might be more likely to be located near and/or on the way to a water
source. To test our this expectation, we deploy a `leaflet` map, which
displays geographical features such as subsurface water, creeks, lakes,
and rivers.

```{r}
#| label: fig-plots7
#| fig-cap: "Habitat Map Of Weeping Mulla Mulla Distribution"
#| fig-align: center
#| echo: false
weeping_mulla_mulla %>%
  leaflet() %>%
  addProviderTiles("Esri.DeLorme") %>%
  setView(lat = -21.833, lng = 128.583, zoom = 5) %>%
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude,  
                   stroke = FALSE, 
                   fillOpacity = 0.1, 
                   color = "#5b9b2e"
)
```

The map is seen in the @fig-plots7, but due to the zoom level, we could
not see the water body features of the map; Therefore, we decided to
investigate a cluster of sightings near Ali Curung.

```{r}
#| label: fig-plots8
#| fig-cap: "Habitat Map Of Weeping Mulla Mulla Distribution(Ali Curung, Barkly)"
#| fig-align: center
#| echo: false
weeping_mulla_mulla %>%
  leaflet() %>%
  addProviderTiles("Esri.DeLorme") %>%
  setView(lat = -20.9358, lng = 134.2996, zoom = 10) %>%
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude,  
                   stroke = FALSE, 
                   fillOpacity = 0.5, 
                   color = "#5b9b2e"
) 
```

Based on the map above (@fig-plots8), we can see that the main cluster
of **Weeping Mulla Mulla** does not live near a water source, which is
different from what we expected. This suggests that the plant is
dependent on rain, meaning that high precipitation periods might lead to
higher sightings. It is also interesting to see that these sightings
were near the National 87 road, implying that these reports were made by
passersby.

### Precipitation and sighting annually

The additional data from the `tenant creek airport` weather station
allows us to investigate the relation between precipitation and sighting
directly, resulting in the graph below which visualizes annual average
rainfall and annual sightings.

```{r echo=FALSE}
#| label: fig-plots9
#| fig-cap: "Sighting Count and Average Precipitation by Year \n(Barkly and Tennant Creek Station)"
#| fig-align: center
#| echo: false
average_precipitation <- temperature %>%
  mutate(Year = lubridate::year(date)) %>%
  group_by(Year) %>%
  summarise(total_prcp = sum(prcp, na.rm = TRUE)) %>%
  mutate(avg_prcp = total_prcp / 365)
  

rainplot <- temperature %>%
  filter(sighting == 1) %>%
  group_by(Year) %>%
  summarise(sighting_count = n()) %>%
  ggplot() +
  geom_bar(aes(x = as.factor(Year), y = sighting_count), stat = "identity", fill = "aquamarine4") +
  geom_line(data = average_precipitation, aes(x = as.factor(Year), y = avg_prcp, group = 1), color = "#c599b2", linewidth = 1) +
  geom_point(data = average_precipitation, aes(x = as.factor(Year), y = avg_prcp), color = "#c599b2") +
  labs(x = "Year", y = "Sighting Count",
       title = "Sighting Count and Average Precipitation by Year \n(Barkly and Tennant Creek Station)",
       color = "Average Precipitation",
       secondary = "Average Precipitation (mm)") +
  scale_y_continuous(name = "Sighting Count",
                     sec.axis = sec_axis(~., name = "Average Precipitation (mm)")) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        axis.title.y = element_text(color = "aquamarine4"),
        axis.title.y.right = element_text(color = "#c599b2"))

rainplot
```

From the @fig-plots9, we can see there are multiple gaps in the sighting
of the **Weeping Mulla Mulla** from 2004 to 2023. This inconsistency can
be explained by the lack of popularity of our plant species. As
addressed above in the **Trend expectation** section, 2015 saw an
abnormally high sighting count, despite a normal annual average
precipitation figure for that year, especially when there were no
sighting records in 2013-2014. We can hypothesize a delayed effect of
plant sightings where years with decreasing rainfall will be accompanied
by sightings when the annual average precipitation begins to trend
upward. For instance, 2006 - 2007 saw a decreasing trend in rainfall
without any plant sightings; However, 2008 saw new reported sightings,
as well as the start of increasing precipitation trend from 2008 to
2011. Another example is when the downward trend from 2011 to 2013 saw
dwindling sightings with increasing rainfall but from 2015 onwards,
sightings were much higher and there were fewer gaps in annual
sightings. Perhaps this is due to preference for dry weather of the
plants; therefore, decreasing precips allow the **Weeping Mulla Mulla**
to thrive better in constrast to being overwatered in wetter years.

### Temperature and sightings

Since the rainfall data did not signify any concrete answers, we decided
to also investigate the daily average temperature and whether that date
has a reported sighting. This is to determine at what average
temperature that sighting is likely to be made.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#| label: fig-plots10
#| fig-cap: "Daily Mean Temperature and Sightings (Barkly) (2004-2023)"
#| fig-align: center
#| echo: false
sighting_data <- temperature %>%
  filter(sighting == 1) %>%
  distinct(date, .keep_all = TRUE)

temperature$mean_temp <- (temperature$tmax + temperature$tmin) / 2

ggplot(temperature, aes(x = as.Date(date))) +
  geom_line(aes(y = mean_temp), size = 1, color = "aquamarine4", alpha = 0.5) +
  geom_bar(data = sighting_data, aes(y = 40), stat = "identity", width = 5, fill = "maroon", alpha = 0.7) +
  labs(x = "Date", y = "Mean Temperature (Celsius)",
       title = "Daily Mean Temperature and Sightings (Barkly)",
       color = "Mean Temperature") +
  coord_cartesian(ylim = c(10, 40)) +
  theme_classic()
```

**Discussion**

@fig-plots10 depicts that, even when the data ranges from 2004 to 2023,
there are very little reported sightings of the **Weeping Mulla Mulla**
in *Barkly*. Nonetheless, we can observe that most of the years have
very similar seasonality trend for average temperatures; thus, we
decided to investigate 2015 as it has the most reported sightings.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#| label: fig-plots11
#| fig-cap: "Daily Mean Temperature, Sighting, Plant Active Window (Barkly, 2015)"
#| fig-align: center
#| echo: false
sighting_data <- temperature %>%
  filter(sighting == 1) %>%
  distinct(date, .keep_all = TRUE)

temperature$mean_temp <- (temperature$tmax + temperature$tmin) / 2

march_oct_data <- temperature %>%
  filter(as.Date(date) >= as.Date("2015-03-01") & as.Date(date) <= as.Date("2015-10-31"))

plot_down <- ggplot() +
  geom_line(data = temperature, aes(x = as.Date(date), y = mean_temp), size = 1, color = "aquamarine4", alpha = 0.5) +
  geom_ribbon(data = march_oct_data, aes(x = as.Date(date), ymin = 0, ymax = 40), fill = "maroon", alpha = 0.3) +
  labs(x = "Date", y = "Mean Temperature (Celsius)",
       title = "Daily Mean Temperature and Plant Active Window (Barkly, 2015)",
       color = "Mean Temperature") +
  coord_cartesian(ylim = c(10, 40)) +
  scale_x_date(limits = as.Date(c("2015-01-01", "2015-12-31"))) +
  theme_classic()
  
plotup <-  
  ggplot(temperature, aes(x = as.Date(date))) +
    geom_line(aes(y = mean_temp), size = 1, color = "aquamarine4", alpha = 0.5) +
    geom_bar(data = sighting_data, aes(y = 40), stat = "identity", width = 0.5, fill = "maroon", alpha = 0.7) +
    labs(x = "Date", y = "Mean Temperature (Celsius)",
         title = "Daily Mean Temperature and Sightings (Barkly, 2015)",
         color = "Mean Temperature") +
    coord_cartesian(ylim = c(10, 40)) +
    scale_x_date(limits = as.Date(c("2015-01-01", "2015-12-31"))) +
    theme_classic()

combined_plot <- plot_grid(
  plotup,
  plot_down,
  ncol = 1
)

combined_plot
```

**Discussion**

By narrowing it down to `2015`, we recognize that most of the sightings
happened in the later half of the year, specifically when the weather
begins to get warmer but not during the warmest days (@fig-plots11).
While most of the observations were reported within the "Active" months
of the flower, it is interesting to see that March to early July saw no
reported sightings. We believe that lack of observations is caused by
lack of human observers rather than the plant's blooming characteristics
since we have explored this habit earlier in the **Temporal
expectation** section. Additionally, it is intriguing to observe that
the active months of the plant coincide with the transition from colder
to warmer weather in the lower figure. We also consider the possibility
that the mentality effect of *"the weather is getting warmer"* enables a
greater inclination in people for outdoor ventures - increasing the
sighting frequency of the plant.

## Tourism Exploratory

### Ecotourist interest in Weeping mulla mulla

We firstly narrow down the necessary data related to Ecotourst interest of Weeping mulla mulla by filtering out Trips with "Holiday" purpose only.

```{r, message = FALSE, warning = FALSE}
# Delete white spaces
# wmm_tourism <- wmm_tourism |> mutate(lga2 = str_trim(lga)) 

# Narrow down the trip purpose
wmm_tourism_holiday <- wmm_tourism %>% 
  filter(Purpose %in% c("Holiday"))
```

```{r, warning = FALSE, message = FALSE}
# Running neccessary library
library(sf)

# Calculating total trips for each quarter and region from our joined data
wmm_tourism_tot <- wmm_tourism_holiday %>% 
  group_by(Purpose, region, Year_Quarter, Year) %>% 
  summarise(tot_trip = sum(Trips))

# Plotting time series of total number of trips to each region
ggplot(wmm_tourism_tot, aes(Year_Quarter, tot_trip, color = region))+
  geom_line() +
  labs(title = "Total trips to investigated areas over the years",
       x = "Time series", 
       y = "Total trips (x1000)")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.text = element_text(size = 6), 
        legend.title = element_text(size = 10),
        strip.text = element_text(size = 7, margin = margin(t = 8, b = 8))) +
  facet_wrap(~region, scales = "free_y")

# tourism |> filter(region == "Ashburton")
```

**Discussion**

Through a visual representation of the total trips to each region, it becomes evident that Ashburton (WA) and Barkly attract the highest number of holiday-goers, with peaks nearing 250,000 and over 600,000 visits respectively. Notably, Ashburton and Barkly regions coincide with the highest reported sightings of the Weeping mulla mulla. Furthermore, the surge in visits to these areas aligns with the apex of Weeping mulla mulla sightings around 2015, as showcased in the `Weeping Mulla Mulla Observations by Year` graph. 

Interestingly, while Ashburton (WA) and Barkly are the standout regions in terms of trip numbers, some regions such as East Pilbara, Halls Creek and Victoria River have also seen an upward trend in visitors from 2015 onward. These regions might not match the visitor volume of Ashburton or Barkly, but their growth indicates an increasing tourist interest, which merits attention in the analysis. 

Meanwhile, the subsequent decline in trips to Ashburton and Barkly post-2015 cannot be overlooked. This drop suggests that the factors influencing the initial surge in tourism might have been temporary or have since evolved. The sharp decline post-peak warrants further investigation to discern if it was a result of decreasing Weeping mulla mulla sightings or if other external factors were at play. This hints at a potential connection between these trips and the Weeping mulla mulla. 

However, our current data doesn't provide enough support to solidify this connection, and it remains inconclusive whether the influx of visitors to Ashburton and Barkly was primarily driven by the prominence of the Weeping mulla mulla. A more detailed perspective can be gained by examining the subsequent map, which juxtaposes Weeping mulla mulla sightings with the number of trips to these regions. 

```{r}
# Mapping occurences and trips tp Weeping mulla mulla areas
AU_region_subset <- AU_region %>%
                      st_crop(xmin = 115, xmax = 155, 
                              ymin = -40, ymax = -10)

wmm_tourism_holiday %>%
  ggplot() +
  geom_sf(aes(geometry = geometry, fill = Trips)) +
  geom_sf(data = AU_region_subset, aes(geometry = geometry), 
          fill = "transparent",  
          color = "black",        
          size = 0.5) +
  geom_count(data = weeping_mulla_mulla, aes(x = longitude, y = latitude), alpha = 0.7, color = "red")+ 
  labs(fill = "The total of people visit (x1000)", size = "The number of occurencies recorded")
```

**Discussion**

Expanding on our prior discussion, this map offers an insightful visualization of the relationship between Weeping mulla mulla occurrences and tourism numbers.

The map clearly illustrates a prominent presence of Weeping mulla mulla in the North-central areas of Western Australia and parts of the Northern Territory. Notably, Ashburton, situated in the most vivid blue region, contrasts with Barkly, which is depicted in a darker hue representing fewer tourists. This suggests that the ecological significance of these regions, underscored by the substantial number of Weeping mulla mulla sightings, might not be the main draw for visitors to these areas.

On the other hand, regions closer to the top Western coast, which have sparser Weeping mulla mulla occurrences, exhibit a lighter shade of blue, indicating higher tourism numbers. This discrepancy could point towards the existence of other influential factors driving tourism, such as popular attractions, infrastructural development, or easier accessibility.

## Summary

Our analysis of the **Weeping Mulla Mulla** has confirmed or debunked
several key expectations:

1.  **Spatial Distribution**: The species' sightings are concentrated in
    the north of Western Australia and in the Northern Territory,
    forming the two primary clusters of observations.

2.  **Temporal Patterns**: The majority of **Weeping Mulla Mulla**
    sightings occur between March and October, in line with its thriving
    period during these months.

3.  **Trend Confirmation**: We have observed a consistent number of
    sightings with an increasing trend, attributed to enhanced sighting,
    reporting, and monitoring methods, particularly evident since 2015.
    Remarkably, there was no decline in observations even during the
    COVID lockdown period.

4.  **Habitat Preferences**: Initial expectations were that sightings
    would cluster around areas with a water source, given the plant's
    preference for harsh, dry, and hot sandy habitats. However, our
    analysis reveals a surprising finding. The primary cluster of
    sightings does not necessarily align with water sources, indicating
    the plant's reliance on rain for survival. Additionally, sightings
    are frequently reported near roads, suggesting observations by
    passersby.

5.  **Rainfall Influence**: Considering that the **Weeping Mulla Mulla**
    typically blooms after the wet season, which occurs approximately
    between June and August, we conducted an in-depth analysis of
    rainfall and precipitation. Intriguingly, while there were more
    sightings in March and April during the blooming cycle and
    occasional showers, there was a decrease in sightings during
    thunderstorms and flooding in June and July. The highest number of
    sightings was recorded in August, likely attributed to milder
    downpours. This observation aligns with the inherent nature of the
    **Weeping Mulla Mulla** as a desert plant that thrives without
    relying heavily on water.

In conclusion, the findings in this report affirm that the **Weeping
Mulla Mulla** is an exceptionally unique and endemic plant, exclusively
located in the northern regions of Australia. Tourists seeking to
experience the harsh desert climate can observe it at its peak during
the months of March to October. This desert plant thrives with minimal
water requirements for survival.

## References

### Websites

-   **iNaturalist**. Ptilotus calostachyus Image., Retrieved October 03,
    2023, from
    https://www.inaturalist.org/taxa/869581-Ptilotus-calostachyus.
-   **Florabase**, Ptilotus calostachyus F.Muell., Retrieved September
    29, 2023, from
    https://florabase.dbca.wa.gov.au/browse/profile.php/2704
-   **The Atlas of Living Australia**. Ptilotus calostachyus
    F.Muell.Retrieved September 27, 2023, from
    https://bie.ala.org.au/species/https://id.biodiversity.org.au/node/apni/2910906#
    overview

### Packages

-   **cowplot**: Wilke C (2020). *cowplot: Streamlined Plot Theme and
    Plot Annotations for 'ggplot2'*. R package version 1.1.1,
    https://CRAN.R-project.org/package=cowplot.
-   **galah**: Westgate M, Kellie D, Stevenson M, Newman P (2023).
    *galah: Biodiversity Data from the Living Atlas Community*. R
    package version 1.5.3, https://CRAN.R-project.org/package=galah.
-   **kableExtra**: Zhu H (2021). *kableExtra: Construct Complex Table
    with 'kable' and Pipe Syntax*. R package version 1.3.4,
    https://CRAN.R-project.org/package=kableExtra.
-   **leaflet**: Cheng J, Schloerke B, Karambelkar B, Xie Y (2023).
    *leaflet: Create Interactive Web Maps with the JavaScript 'Leaflet'
    Library*. R package version 2.2.0,
    https://CRAN.R-project.org/package=leaflet.
-   **nullabor**: Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee,
    E.-K., Swayne, D. F, Wickham, H. (2009) Statistical Inference for
    Exploratory Data Analysis and Model Diagnostics Royal Society
    Philosophical Transactions A, 367(1906):4361-4383. URL
    http://rsta.royalsocietypublishing.org/content/367/1906/4361.article-info
-   **plotly**: C. Sievert. Interactive Web-Based Data Visualization
    with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.
-   **rnoaa**: Chamberlain S, Hocking D (2023). *rnoaa: 'NOAA' Weather
    Data from R*. R package version 1.4.0,
    https://CRAN.R-project.org/package=rnoaa.
-   **spData**: Bivand R, Nowosad J, Lovelace R (2023). *spData:
    Datasets for Spatial Analysis*. R
-   **tidyverse**: Wickham H, Averick M, Bryan J, Chang W, McGowan LD,
    FranÃ§ois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M,
    Pedersen TL, Miller E, Bache SM, MÃ¼ller K, Ooms J, Robinson D,
    Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H
    (2019). "Welcome to the tidyverse." *Journal of Open Source
    Software*, *4*(43), 1686. doi:10.21105/joss.01686
    https://doi.org/10.21105/joss.01686.
-   **visdat**: Tierney N (2017). "visdat: Visualising Whole Data
    Frames." *JOSS*, *2*(16), 355. doi:10.21105/joss.00355
    https://doi.org/10.21105/joss.00355,
    http://dx.doi.org/10.21105/joss.00355.
